### YamlMime:NetMember
type: method
members:
- returnsWithMoniker:
    type:
    - value: <xref href="Microsoft.CodeAnalysis.VisualBasic.VisualBasicCompilation?alt=Microsoft.CodeAnalysis.VisualBasic.VisualBasicCompilation&text=VisualBasicCompilation" data-throw-if-not-resolved="True"/>
  parameters:
  - namesWithMoniker:
    - value: newReferences
    type: <xref href="Microsoft.CodeAnalysis.MetadataReference?alt=Microsoft.CodeAnalysis.MetadataReference&text=MetadataReference" data-throw-if-not-resolved="True"/>[]
  type: method
  uid: Microsoft.CodeAnalysis.VisualBasic.VisualBasicCompilation.WithReferences(Microsoft.CodeAnalysis.MetadataReference[])
  commentId: M:Microsoft.CodeAnalysis.VisualBasic.VisualBasicCompilation.WithReferences(Microsoft.CodeAnalysis.MetadataReference[])
  name: WithReferences(MetadataReference[])
  fullName: Microsoft.CodeAnalysis.VisualBasic.VisualBasicCompilation.WithReferences(MetadataReference[])
  nameWithType: VisualBasicCompilation.WithReferences(MetadataReference[])
  syntaxWithMoniker:
  - lang: cpp
    values:
    - value: >-
        public:
         Microsoft::CodeAnalysis::VisualBasic::VisualBasicCompilation ^ WithReferences(... cli::array <Microsoft::CodeAnalysis::MetadataReference ^> ^ newReferences);
  - lang: csharp
    values:
    - value: public Microsoft.CodeAnalysis.VisualBasic.VisualBasicCompilation WithReferences (params Microsoft.CodeAnalysis.MetadataReference[] newReferences);
  - lang: fsharp
    values:
    - value: 'override this.WithReferences : Microsoft.CodeAnalysis.MetadataReference[] -> Microsoft.CodeAnalysis.VisualBasic.VisualBasicCompilation'
  - lang: vb
    values:
    - value: Public Function WithReferences (ParamArray newReferences As MetadataReference()) As VisualBasicCompilation
  monikers:
  - roslyn-dotnet
  - roslyn-dotnet-3.0
  - roslyn-dotnet-3.1
  - roslyn-dotnet-3.10.0
  - roslyn-dotnet-3.11.0
  - roslyn-dotnet-3.2
  - roslyn-dotnet-3.2.1
  - roslyn-dotnet-3.3.1
  - roslyn-dotnet-3.4.0
  - roslyn-dotnet-3.5.0
  - roslyn-dotnet-3.6.0
  - roslyn-dotnet-3.7.0
  - roslyn-dotnet-3.8.0
  - roslyn-dotnet-3.9.0
  - roslyn-dotnet-4.0.1
  - roslyn-dotnet-4.1.0
  - roslyn-dotnet-4.2.0
  metadata: {}
- returnsWithMoniker:
    type:
    - value: <xref href="Microsoft.CodeAnalysis.VisualBasic.VisualBasicCompilation?alt=Microsoft.CodeAnalysis.VisualBasic.VisualBasicCompilation&text=VisualBasicCompilation" data-throw-if-not-resolved="True"/>
  parameters:
  - namesWithMoniker:
    - value: newReferences
    type: <xref href="System.Collections.Generic.IEnumerable`1?alt=System.Collections.Generic.IEnumerable&text=IEnumerable" data-throw-if-not-resolved="True"/>&lt;<xref href="Microsoft.CodeAnalysis.MetadataReference?alt=Microsoft.CodeAnalysis.MetadataReference&text=MetadataReference" data-throw-if-not-resolved="True"/>&gt;
  type: method
  uid: Microsoft.CodeAnalysis.VisualBasic.VisualBasicCompilation.WithReferences(System.Collections.Generic.IEnumerable{Microsoft.CodeAnalysis.MetadataReference})
  commentId: M:Microsoft.CodeAnalysis.VisualBasic.VisualBasicCompilation.WithReferences(System.Collections.Generic.IEnumerable{Microsoft.CodeAnalysis.MetadataReference})
  name: WithReferences(IEnumerable<MetadataReference>)
  fullName: Microsoft.CodeAnalysis.VisualBasic.VisualBasicCompilation.WithReferences(IEnumerable<MetadataReference>)
  nameWithType: VisualBasicCompilation.WithReferences(IEnumerable<MetadataReference>)
  syntaxWithMoniker:
  - lang: cpp
    values:
    - value: >-
        public:
         Microsoft::CodeAnalysis::VisualBasic::VisualBasicCompilation ^ WithReferences(System::Collections::Generic::IEnumerable<Microsoft::CodeAnalysis::MetadataReference ^> ^ newReferences);
  - lang: csharp
    values:
    - value: public Microsoft.CodeAnalysis.VisualBasic.VisualBasicCompilation WithReferences (System.Collections.Generic.IEnumerable<Microsoft.CodeAnalysis.MetadataReference> newReferences);
  - lang: fsharp
    values:
    - value: 'override this.WithReferences : seq<Microsoft.CodeAnalysis.MetadataReference> -> Microsoft.CodeAnalysis.VisualBasic.VisualBasicCompilation'
  - lang: vb
    values:
    - value: Public Function WithReferences (newReferences As IEnumerable(Of MetadataReference)) As VisualBasicCompilation
  monikers:
  - roslyn-dotnet
  - roslyn-dotnet-3.0
  - roslyn-dotnet-3.1
  - roslyn-dotnet-3.10.0
  - roslyn-dotnet-3.11.0
  - roslyn-dotnet-3.2
  - roslyn-dotnet-3.2.1
  - roslyn-dotnet-3.3.1
  - roslyn-dotnet-3.4.0
  - roslyn-dotnet-3.5.0
  - roslyn-dotnet-3.6.0
  - roslyn-dotnet-3.7.0
  - roslyn-dotnet-3.8.0
  - roslyn-dotnet-3.9.0
  - roslyn-dotnet-4.0.1
  - roslyn-dotnet-4.1.0
  - roslyn-dotnet-4.2.0
  summary: Creates a new compilation with the specified references.
  remarks: <p>The new <xref data-throw-if-not-resolved="true" uid="Microsoft.CodeAnalysis.VisualBasic.VisualBasicCompilation"></xref> will query the given <xref data-throw-if-not-resolved="true" uid="Microsoft.CodeAnalysis.MetadataReference"></xref> for the underlying metadata as soon as the are needed.</p><p>The New compilation uses whatever metadata is currently being provided by the <xref data-throw-if-not-resolved="true" uid="Microsoft.CodeAnalysis.MetadataReference"></xref>. E.g. if the current compilation references a metadata file that has changed since the creation of the compilation the New compilation is going to use the updated version, while the current compilation will be using the previous (it doesn't change).</p>
  metadata: {}
uid: Microsoft.CodeAnalysis.VisualBasic.VisualBasicCompilation.WithReferences*
commentId: Overload:Microsoft.CodeAnalysis.VisualBasic.VisualBasicCompilation.WithReferences
namespace: Microsoft.CodeAnalysis.VisualBasic
name: WithReferences
fullName: Microsoft.CodeAnalysis.VisualBasic.VisualBasicCompilation.WithReferences
nameWithType: VisualBasicCompilation.WithReferences
assembliesWithMoniker:
- value: Microsoft.CodeAnalysis.VisualBasic.dll
packagesWithMoniker:
- value: Microsoft.CodeAnalysis.VisualBasic v3.0.0
  monikers:
  - roslyn-dotnet-3.0
- value: Microsoft.CodeAnalysis.VisualBasic v3.1.0
  monikers:
  - roslyn-dotnet-3.1
- value: Microsoft.CodeAnalysis.VisualBasic v3.10.0
  monikers:
  - roslyn-dotnet-3.10.0
- value: Microsoft.CodeAnalysis.VisualBasic v3.11.0
  monikers:
  - roslyn-dotnet-3.11.0
- value: Microsoft.CodeAnalysis.VisualBasic v3.2.0
  monikers:
  - roslyn-dotnet-3.2
- value: Microsoft.CodeAnalysis.VisualBasic v3.2.1
  monikers:
  - roslyn-dotnet-3.2.1
- value: Microsoft.CodeAnalysis.VisualBasic v3.3.1
  monikers:
  - roslyn-dotnet-3.3.1
- value: Microsoft.CodeAnalysis.VisualBasic v3.4.0
  monikers:
  - roslyn-dotnet-3.4.0
- value: Microsoft.CodeAnalysis.VisualBasic v3.5.0
  monikers:
  - roslyn-dotnet-3.5.0
- value: Microsoft.CodeAnalysis.VisualBasic v3.6.0
  monikers:
  - roslyn-dotnet-3.6.0
- value: Microsoft.CodeAnalysis.VisualBasic v3.7.0
  monikers:
  - roslyn-dotnet-3.7.0
- value: Microsoft.CodeAnalysis.VisualBasic v3.8.0
  monikers:
  - roslyn-dotnet-3.8.0
- value: Microsoft.CodeAnalysis.VisualBasic v3.9.0
  monikers:
  - roslyn-dotnet-3.9.0
- value: Microsoft.CodeAnalysis.VisualBasic v4.0.1
  monikers:
  - roslyn-dotnet-4.0.1
- value: Microsoft.CodeAnalysis.VisualBasic v4.1.0
  monikers:
  - roslyn-dotnet-4.1.0
- value: Microsoft.CodeAnalysis.VisualBasic v4.2.0
  monikers:
  - roslyn-dotnet-4.2.0
devLangs:
- cpp
- csharp
- vb
- fsharp
monikers:
- roslyn-dotnet
- roslyn-dotnet-3.0
- roslyn-dotnet-3.1
- roslyn-dotnet-3.10.0
- roslyn-dotnet-3.11.0
- roslyn-dotnet-3.2
- roslyn-dotnet-3.2.1
- roslyn-dotnet-3.3.1
- roslyn-dotnet-3.4.0
- roslyn-dotnet-3.5.0
- roslyn-dotnet-3.6.0
- roslyn-dotnet-3.7.0
- roslyn-dotnet-3.8.0
- roslyn-dotnet-3.9.0
- roslyn-dotnet-4.0.1
- roslyn-dotnet-4.1.0
- roslyn-dotnet-4.2.0
metadata:
  api_name:
  - Microsoft.CodeAnalysis.VisualBasic.VisualBasicCompilation.WithReferences
  api_location:
  - Microsoft.CodeAnalysis.VisualBasic.dll
  topic_type:
  - apiref
  api_type:
  - Assembly
  f1_keywords:
  - Microsoft.CodeAnalysis.VisualBasic.VisualBasicCompilation.WithReferences
  - Microsoft::CodeAnalysis::VisualBasic::VisualBasicCompilation::WithReferences
  - WithReferences
  - VisualBasicCompilation.WithReferences
  - VisualBasicCompilation::WithReferences
  helpviewer_keywords:
  - VisualBasicCompilation.WithReferences method [.NET]
  - WithReferences method [.NET], class VisualBasicCompilation
  - VisualBasicCompilation.WithReferences(MetadataReference[]) method [.NET]
  - WithReferences(MetadataReference[]) method [.NET], class VisualBasicCompilation
  - VisualBasicCompilation.WithReferences(IEnumerable<MetadataReference>) method [.NET]
  - WithReferences(IEnumerable<MetadataReference>) method [.NET], class VisualBasicCompilation
  monikers:
  - roslyn-dotnet
  - roslyn-dotnet-3.0
  - roslyn-dotnet-3.1
  - roslyn-dotnet-3.10.0
  - roslyn-dotnet-3.11.0
  - roslyn-dotnet-3.2
  - roslyn-dotnet-3.2.1
  - roslyn-dotnet-3.3.1
  - roslyn-dotnet-3.4.0
  - roslyn-dotnet-3.5.0
  - roslyn-dotnet-3.6.0
  - roslyn-dotnet-3.7.0
  - roslyn-dotnet-3.8.0
  - roslyn-dotnet-3.9.0
  - roslyn-dotnet-4.0.1
  - roslyn-dotnet-4.1.0
  - roslyn-dotnet-4.2.0
